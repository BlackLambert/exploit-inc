using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using SBaier.Input;
using Zenject;

namespace SBaier.ExploitInc
{
	public class MissionCameraKeyMovement : MonoBehaviour
	{
		[SerializeField]
		private GameObject _planetCenter;
		[SerializeField]
		private float _delta = 0.01f;

		private ButtonInputRegistry _buttonInputRegistry;

		[Inject]
		private void Construct(ButtonInputRegistry buttonInputRegistry)
		{
			_buttonInputRegistry = buttonInputRegistry;
		}

		protected virtual void OnEnable()
		{
			_buttonInputRegistry.Subscribe(KeyCode.UpArrow, ButtonState.Pressed, moveUp);
			_buttonInputRegistry.Subscribe(KeyCode.DownArrow, ButtonState.Pressed, moveDown);
			_buttonInputRegistry.Subscribe(KeyCode.LeftArrow, ButtonState.Pressed, moveLeft);
			_buttonInputRegistry.Subscribe(KeyCode.RightArrow, ButtonState.Pressed, moveRight);
		}

		protected virtual void OnDisable()
		{
			_buttonInputRegistry.Unsubscribe(KeyCode.UpArrow, ButtonState.Pressed, moveUp);
			_buttonInputRegistry.Unsubscribe(KeyCode.DownArrow, ButtonState.Pressed, moveDown);
			_buttonInputRegistry.Unsubscribe(KeyCode.LeftArrow, ButtonState.Pressed, moveLeft);
			_buttonInputRegistry.Unsubscribe(KeyCode.RightArrow, ButtonState.Pressed, moveRight);
		}

		private void moveUp(ButtonInputEventArgs args)
		{
			moveBy(new Vector3(_delta, 0, 0) * Time.deltaTime);
		}

		private void moveDown(ButtonInputEventArgs args)
		{
			moveBy(new Vector3(-_delta, 0, 0) * Time.deltaTime);
		}

		private void moveLeft(ButtonInputEventArgs args)
		{
			moveBy(new Vector3(0, 0, _delta) * Time.deltaTime);
		}

		private void moveRight(ButtonInputEventArgs args)
		{
			moveBy(new Vector3(0, 0, -_delta) * Time.deltaTime);
		}

		private void moveBy(Vector3 delta)
		{
			_planetCenter.transform.rotation = _planetCenter.transform.rotation * Quaternion.Euler(delta);
		}
	}
}