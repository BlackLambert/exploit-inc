using UnityEngine;
using Zenject;

namespace SBaier.ExploitInc
{
	public class StarsCreator : MonoBehaviour
	{
		[SerializeField]
		private GameObject _hook = null;

		private StarsConfig _starsConfig = null;


		[Inject]
		private void Construct(StarsConfig starsConfig)
		{
			_starsConfig = starsConfig;
		}

		protected virtual void Start()
		{
			createStars();
		}

		private void createStars()
		{
			for(int i= 0;i< _starsConfig.Count; i++)
				createStar();
		}

		private Vector3 createRandomDistanceVector()
		{
			float x = Random.Range(-1f, 1f);
			float y = Random.Range(-1f, 1f);
			float z = Random.Range(-1f, 1f);
			Vector3 vector3 = new Vector3(x, y, z);
			if (vector3 == Vector3.zero)
				vector3 = createRandomDistanceVector();
			return vector3.normalized * _starsConfig.Distance;
		}

		private void createStar()
		{
			GameObject result = GameObject.Instantiate(_starsConfig.StarPrefab, _hook.transform);
			result.transform.localPosition = createRandomDistanceVector();
			float scale = Random.Range(_starsConfig.MinScale, _starsConfig.MaxScale);
			result.transform.localScale = new Vector3(scale, scale, scale);
		}
	}
}