using System;
using UnityEngine;
using Zenject;

namespace SBaier.ExploitInc
{
	public class InfoBox : MonoBehaviour
	{
		private InfoBoxParameter _parameter; 
		private Camera _cam;

		[SerializeField]
		private Transform _menuBase = null;
		[SerializeField]
		private MenuShower _menuShower = null;

		[Inject]
		private void Construct([Inject(Id = "InputCamera")]Camera cam, 
			InfoBoxParameter parameter)
		{
			_cam = cam;
			_parameter = parameter;
		}

		protected virtual void Awake()
		{
			_menuBase.position = _cam.WorldToScreenPoint(_parameter.Position);
		}

		protected virtual void Update()
		{
			_menuBase.position = _cam.WorldToScreenPoint(_parameter.Position);
		}

		public void Show()
		{
			_menuShower.Show();
		}

		public void Hide()
		{
			_menuShower.Hide();
			_menuShower.OnHidden += onHidden;
		}

		private void onHidden()
		{
			_menuShower.OnHidden -= onHidden;
			Destroy(_menuBase.gameObject);
		}
	}
}