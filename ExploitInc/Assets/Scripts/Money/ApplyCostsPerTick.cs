using UnityEngine;
using Zenject;
using System.Linq;

namespace SBaier.ExploitInc
{
	public class ApplyCostsPerTick : MonoBehaviour
	{
		private CostsPerTick _costsPerTick;
		private MissionData _missionData;

		[Inject]
		private void Construct(CostsPerTick costsPerTick,
			MissionData missionData)
		{
			_costsPerTick = costsPerTick;
			_missionData = missionData;
		}

		protected virtual void Start()
		{
			_costsPerTick.OnTick += applyCosts;
		}

		protected virtual void OnDestroy()
		{
			_costsPerTick.OnTick -= applyCosts;
		}

		private void applyCosts()
		{
			if (_missionData.State != MissionState.OnGoing)
				return;
			_missionData.ReduceMoney(_costsPerTick.Costs);
		}
	}
}